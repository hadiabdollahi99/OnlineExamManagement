<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Ø¢Ø²Ù…ÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ø¯ÙˆØ±Ù‡</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        .menu { background: #333; padding: 10px; margin-bottom: 20px; }
        .menu a { color: white; margin: 0 10px; text-decoration: none; }
        .menu form { color: white; margin: 0 10px; text-decoration: none;}
        .course-header { background: #f8f9fa; padding: 15px; margin-bottom: 20px; border-right: 4px solid #007bff;}
        .btn { padding: 8px 15px; text-decoration: none; color: white; margin: 5px; display: inline-block;}
        .btn-add { background: #28a745; }
        .btn-back { background: #6c757d; }
        .btn-view { background: #007bff; }
        .btn-edit { background: #ffc107; color: black; }
        .btn-delete { background: #dc3545; }
        .btn-question { background: #28a745; color: white;}
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: right; }
        th { background: #f8f9fa; }
        .teacher-badge { display: inline-block; padding: 2px 8px; background: #6c757d; color: white; border-radius: 10px; font-size: 12px; margin-right: 5px;}
        .no-exams {
            text-align: center;
            padding: 50px;
            color: #666;
            background: #f9f9f9;
            margin-top: 20px;
        }
        .teacher-filter {
            margin: 20px 0;
            padding: 10px;
            background: #f1f1f1;
        }
        form { display: inline; }
        .status-active { color: green; }
        .status-inactive { color: red; }
    </style>
</head>
<body>
<div class="menu">
    <a href="/teacher/dashboard">Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</a>
    <a href="/teacher/courses">Ø¯ÙˆØ±Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ù†</a>
    <form th:action="@{/logout}" method="post">
        <button type="submit">Ø®Ø±ÙˆØ¬</button>
    </form></div>

<div class="course-header">
    <h3>Ø¢Ø²Ù…ÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ø¯ÙˆØ±Ù‡: <span th:text="${course.title}"></span></h3>
    <p>Ú©Ø¯ Ø¯ÙˆØ±Ù‡: <span th:text="${course.courseCode}"></span></p>
    <p th:if="${isCurrentTeacher}" style="color: green;">
        âœ“ Ø´Ù…Ø§ Ø§Ø³ØªØ§Ø¯ ÙØ¹Ù„ÛŒ Ø§ÛŒÙ† Ø¯ÙˆØ±Ù‡ Ù‡Ø³ØªÛŒØ¯
    </p>
    <p th:unless="${isCurrentTeacher}" style="color: orange;">
        âš  Ø´Ù…Ø§ Ø§Ø³ØªØ§Ø¯ ÙØ¹Ù„ÛŒ Ø§ÛŒÙ† Ø¯ÙˆØ±Ù‡ Ù†ÛŒØ³ØªÛŒØ¯
    </p>
</div>

<div>
    <a th:href="@{/teacher/courses/{id}/exams/new(id=${course.id})}"
       th:if="${isCurrentTeacher}"
       class="btn btn-add">â• Ø§ÙØ²ÙˆØ¯Ù† Ø¢Ø²Ù…ÙˆÙ† Ø¬Ø¯ÛŒØ¯</a>
    <a href="/teacher/courses" class="btn btn-back">â† Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¯ÙˆØ±Ù‡â€ŒÙ‡Ø§</a>
</div>

<div th:if="${not #lists.isEmpty(examTeachers)}" class="teacher-filter">
    <strong>Ø§Ø³ØªØ§Ø¯Ù‡Ø§ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†Ù†Ø¯Ù‡ Ø¢Ø²Ù…ÙˆÙ†:</strong>
    <span th:each="teacher : ${examTeachers}">
            <span class="teacher-badge" th:text="${teacher.firstName + ' ' + teacher.lastName}"></span>
        </span>
</div>

<div th:if="${allExams.empty}" class="no-exams">
    <p>Ù‡Ù†ÙˆØ² Ù‡ÛŒÚ† Ø¢Ø²Ù…ÙˆÙ†ÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø¯ÙˆØ±Ù‡ Ø§ÛŒØ¬Ø§Ø¯ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
    <p th:if="${isCurrentTeacher}">
        Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø¨Ø± Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ "Ø§ÙØ²ÙˆØ¯Ù† Ø¢Ø²Ù…ÙˆÙ† Ø¬Ø¯ÛŒØ¯" Ø§ÙˆÙ„ÛŒÙ† Ø¢Ø²Ù…ÙˆÙ† Ø±Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†ÛŒØ¯.
    </p>
</div>

<div th:unless="${allExams.empty}">
    <table>
        <thead>
        <tr>
            <th>Ø¹Ù†ÙˆØ§Ù† Ø¢Ø²Ù…ÙˆÙ†</th>
            <th>Ø§Ø³ØªØ§Ø¯ Ø§ÛŒØ¬Ø§Ø¯ Ú©Ù†Ù†Ø¯Ù‡</th>
            <th>Ø²Ù…Ø§Ù† (Ø¯Ù‚ÛŒÙ‚Ù‡)</th>
            <th>ØªØ¹Ø¯Ø§Ø¯ Ø³ÙˆØ§Ù„Ø§Øª</th>
            <th>ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯</th>
            <th>ÙˆØ¶Ø¹ÛŒØª</th>
            <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="exam : ${allExams}"
            th:classappend="${exam.teacher.id == currentTeacherId} ? 'my-exam' : 'other-exam'">

            <td th:text="${exam.title}"></td>

            <td>
                <span th:text="${exam.teacher.firstName + ' ' + exam.teacher.lastName}"></span>
                <span th:if="${exam.teacher.id == currentTeacherId}"
                      style="color: green;"> (Ø´Ù…Ø§)</span>
            </td>

            <td th:text="${exam.durationMinutes}"></td>
            <td th:text="0"></td>
            <td th:text="${#temporals.format(exam.createdAt, 'yyyy/MM/dd')}"></td>

            <td>
                <span th:if="${exam.isActive}" class="status-active">ÙØ¹Ø§Ù„</span>
                <span th:unless="${exam.isActive}" class="status-inactive">ØºÛŒØ±ÙØ¹Ø§Ù„</span>
            </td>

            <td>
                <a th:href="@{/teacher/exams/{id}(id=${exam.id})}"
                   class="btn btn-view">ğŸ‘ï¸ Ù…Ø´Ø§Ù‡Ø¯Ù‡</a>

                <a th:href="@{/teacher/exams/{id}/edit(id=${exam.id})}"
                   th:if="${exam.teacher.id == currentTeacherId}"
                   class="btn btn-edit">âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´</a>
                <a th:href="@{/teacher/questions/exam/{id}(id=${exam.id})}"
                   th:if="${exam.teacher.id == currentTeacherId}"
                   class="btn btn-question">
                    ğŸ“ Ø³ÙˆØ§Ù„Ø§Øª
                </a>

                <form th:action="@{/teacher/exams/{id}/delete(id=${exam.id})}"
                      th:if="${exam.teacher.id == currentTeacherId}"
                      method="post">
                    <button type="submit" class="btn btn-delete"
                            onclick="return confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ø¢Ø²Ù…ÙˆÙ† Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ')">
                        ğŸ—‘ï¸ Ø­Ø°Ù
                    </button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>

    <div style="margin-top: 20px; padding: 15px; background: #f8f9fa;">
        <p>
            <strong>Ø¢Ù…Ø§Ø± Ø¢Ø²Ù…ÙˆÙ†â€ŒÙ‡Ø§:</strong>
            | Ú©Ù„ Ø¢Ø²Ù…ÙˆÙ†â€ŒÙ‡Ø§: <span th:text="${allExams.size()}"></span>
            | Ø¢Ø²Ù…ÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§: <span th:text="${myExams.size()}"></span>
            | Ø³Ø§ÛŒØ± Ø¢Ø²Ù…ÙˆÙ†â€ŒÙ‡Ø§: <span th:text="${allExams.size() - myExams.size()}"></span>
        </p>
    </div>
</div>
</body>
</html>